name: manual deploy demo

on:
  workflow_dispatch:

# available to all jobs/steps unless overridden
env:
  AWS_REGION: us-east-1
  ENVIRONMENT: production

jobs:
  deploy-to-aws:
    runs-on: ubuntu-latest

    # job-level env example
    env:
      DEPLOYMENT_NAME: demo-deploy

    steps:
      - name: checkout
        uses: actions/checkout@v4

      - name: show workflow env
        run: |
          echo "ENVIRONMENT=$ENVIRONMENT"
          echo "AWS_REGION=$AWS_REGION"

      - name: show job env
        run: echo "DEPLOYMENT_NAME=$DEPLOYMENT_NAME"

      - name: use secrets (will be masked)
        env:
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
        run: |
          echo "AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID"
          echo "AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY"

      - name: step env override
        env:
          ENVIRONMENT: staging
          STEP_TAG: v1.0.0
        run: |
          echo "ENVIRONMENT (step)=$ENVIRONMENT"
          echo "AWS_REGION (from workflow)=$AWS_REGION"
          echo "DEPLOYMENT_NAME (job)=$DEPLOYMENT_NAME"
          echo "STEP_TAG=$STEP_TAG"
